{
    "contents" : "library(boot)\nlibrary(ggplot2)\nlibrary(gridExtra)\nsetwd(\"~/Dropbox/UT Biostat/CHL7001 Statistical Analysis of Health Economic Data/\")\ndt <- read.csv(\"./Data/fluoxpin.csv\")\n\np1 <- ggplot(data = dt, aes(x = cost)) + theme_minimal() +\n  labs(x = \"Cost\", y = \"Count\", title = \"Histogram of costs by flxpin group\") +\n  geom_histogram(aes(fill = factor(flxpin)), bins = 100) + \n  scale_fill_discrete(name = \"Fluoxetine\", labels = c(\"No\", \"Yes\")) \np2 <- ggplot(data = subset(dt, flxpin == 0), aes(x = cost)) + theme_minimal() +\n  labs(x = \"Cost\", y = \"Density\", title = \"Density of costs without fluoxetine\") +\n  geom_density() \np3 <- ggplot(data = subset(dt, flxpin == 1), aes(x = cost)) + theme_minimal() +\n  labs(x = \"Cost\", y = \"Density\", title = \"Density of costs with fluoxetine\") +\n  geom_density() \n\npng(\"Img/02density.png\", width = 480, height = 480)\ngrid.arrange(p1,p2,p3, ncol = 2, nrow = 2, layout_matrix = rbind(c(1,1), c(2,3)))\ndev.off()\n    \nteqv <- t.test(dt$cost~dt$flxpin, var.equal = TRUE, paired = FALSE)\ntneqv <-t.test(dt$cost~dt$flxpin, var.equal = FALSE, paired = FALSE)\n\nmeangrp <- function(data, index) return(mean(data[index]))\nboottest0 <- boot(dt$cost[dt$flxpin == 0], meangrp, 20000)\nboottest1 <- boot(dt$cost[dt$flxpin == 1], meangrp, 20000)\n\nbootdf <- data.frame(flx0 = boottest0$t, flx1 = boottest1$t)\n\nggplot(data = bootdf, aes(x = flx0)) +\n  theme_minimal() + labs(title = \"Histogram of bootstrap sample mean\\nwithout fluoxetine\") +\n  geom_histogram(bins = 50, alpha = 0.8)\n\nggplot(data = bootdf, aes(x = flx1)) +\n  theme_minimal() + labs(title = \"Histogram of bootstrap sample mean\\nwith fluoxetine\") +\n  geom_histogram(bins = 50, alpha = 0.8)\n\nbootests <- data.frame(est = c(\"Estimate\", \"95% confidence interval\", \"95% confidence interval\"),\n                       val = c(median(bootdf$flx0 - bootdf$flx1),\n                               quantile(bootdf$flx0 - bootdf$flx1, 0.025),\n                               quantile(bootdf$flx0 - bootdf$flx1, 0.975)),\n                       row.names = NULL)\n\npng(\"Img/02bootres.png\", width = 480, height = 480)\nggplot(data = bootdf, aes(x = flx0 - flx1)) +\n  theme_minimal() + labs(title = \"Histogram of bootstrap sample mean difference\",\n                         y = \"Count\", x = \"Mean cost difference\") +\n  geom_histogram(bins = 50, alpha = 0.8) +\n  geom_vline(data = bootests, aes(xintercept = val, color = est)) +\n  scale_color_discrete(name = \"\", breaks = c(\"Estimate\", \"95% confidence interval\"))\ndev.off()\n\nbootests <- rbind(bootests, data.frame(est = \"P-value\", \n                                       val = sum(bootdf$flx0 - bootdf$flx1 <= 0)/length(bootdf$flx0)*2))\n",
    "created" : 1465478724290.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1618006397",
    "id" : "65653746",
    "lastKnownWriteTime" : 1465411829,
    "path" : "~/Dropbox/UT Biostat/CHL7001 Statistical Analysis of Health Economic Data/lecture02.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}